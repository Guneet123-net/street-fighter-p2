<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Street Brawler</title>
<style>
body {
    margin: 0;
    background: linear-gradient(to top, #222, #555);
    overflow: hidden;
    font-family: Arial, sans-serif;
}

canvas {
    display: block;
    margin: auto;
    background: linear-gradient(#87CEEB, #e0e0e0);
    border: 4px solid black;
}

#ui {
    position: absolute;
    top: 10px;
    width: 100%;
    text-align: center;
    color: white;
    font-size: 20px;
    font-weight: bold;
}
</style>
</head>
<body>

<div id="ui">
    <span id="p1Health">Player: 100</span>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <span id="p2Health">CPU: 100</span>
</div>

<canvas id="game" width="900" height="450"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

class Fighter {
    constructor(x, color, isAI = false) {
        this.x = x;
        this.y = 330;
        this.width = 60;
        this.height = 120;
        this.color = color;
        this.health = 100;
        this.velocityY = 0;
        this.speed = 5;
        this.isJumping = false;
        this.isAttacking = false;
        this.attackType = null;
        this.isAI = isAI;
    }

    draw() {
        ctx.fillStyle = this.color;
        ctx.fillRect(this.x, this.y, this.width, this.height);

        if (this.isAttacking) {
            ctx.fillStyle = "yellow";
            ctx.fillRect(
                this.x + (this.color === "blue" ? this.width : -30),
                this.y + 40,
                30,
                20
            );
        }
    }

    update() {
        this.y += this.velocityY;
        this.velocityY += 0.5;

        if (this.y >= 330) {
            this.y = 330;
            this.velocityY = 0;
            this.isJumping = false;
        }

        if (this.isAttacking) {
            setTimeout(() => {
                this.isAttacking = false;
            }, 200);
        }
    }

    jump() {
        if (!this.isJumping) {
            this.velocityY = -12;
            this.isJumping = true;
        }
    }

    attack(type) {
        this.isAttacking = true;
        this.attackType = type;
    }
}

const player = new Fighter(200, "blue");
const cpu = new Fighter(600, "red", true);

const keys = {};

document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

function checkCollision(attacker, defender) {
    if (
        attacker.isAttacking &&
        attacker.x + attacker.width > defender.x &&
        attacker.x < defender.x + defender.width &&
        Math.abs(attacker.y - defender.y) < 50
    ) {
        defender.health -= attacker.attackType === "kick" ? 10 : 5;
        updateUI();
    }
}

function updateUI() {
    document.getElementById("p1Health").textContent = "Player: " + player.health;
    document.getElementById("p2Health").textContent = "CPU: " + cpu.health;
}

function cpuAI() {
    if (!cpu.isAI || cpu.health <= 0) return;

    if (cpu.x > player.x + 80) cpu.x -= 2;
    else if (cpu.x < player.x - 80) cpu.x += 2;

    if (Math.random() < 0.02) cpu.jump();
    if (Math.random() < 0.03) cpu.attack(Math.random() > 0.5 ? "punch" : "kick");
}

function gameLoop() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Player movement
    if (keys["a"]) player.x -= player.speed;
    if (keys["d"]) player.x += player.speed;
    if (keys["w"]) player.jump();
    if (keys["j"]) player.attack("punch");
    if (keys["k"]) player.attack("kick");

    player.update();
    cpu.update();
    cpuAI();

    checkCollision(player, cpu);
    checkCollision(cpu, player);

    player.draw();
    cpu.draw();

    if (player.health <= 0 || cpu.health <= 0) {
        ctx.fillStyle = "black";
        ctx.font = "50px Arial";
        ctx.fillText(
            player.health <= 0 ? "CPU WINS!" : "PLAYER WINS!",
            300,
            200
        );
        return;
    }

    requestAnimationFrame(gameLoop);
}

updateUI();
gameLoop();
</script>

</body>
</html>
